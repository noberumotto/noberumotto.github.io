# ä»w95ä»“åº“æ‹‰å–æºç ç„¶åæ„å»ºé™æ€ç½‘é¡µ

name: Build & Deploy from w95 repo

on:
  # åªæœ‰åœ¨ master åˆ†æ”¯ä¿®æ”¹æ—¶æ‰§è¡Œ
  push:
    branches: [ "master" ]

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

jobs:
  # æ‹‰å–ä¸¤ä¸ªä»“åº“æ–‡ä»¶ç„¶åæ„å»º
  build:
    # The type of runner that the job will run on
    runs-on: windows-2019

    # Steps represent a sequence of tasks that will be executed as part of the job
    steps:
      # è·å–é™æ€æ•°æ®
      - name: checkout data ğŸ’½
        uses: actions/checkout@v3
        with:
          path: data

      # è·å–æºç 
      - name: clone w95 ğŸ“€
        uses: actions/checkout@v3
        with:
          repository: noberumotto/w95
          path: w95

      # åˆå¹¶
      - name: copy files ğŸ’¾
        run: |
          Xcopy /Y /E /I data w95\source\src
          cd w95\source\src
          dir
      # æ„å»ºé™æ€æ–‡ä»¶
      - name: build ğŸ› 
        working-directory: w95\source
        run: |
          npm install
          npm run w95file
          npm run build
      # ä¸Šä¼ 
      - name: upload ğŸ“¤
        uses: actions/upload-artifact@v1
        with:
          name: site
          path: w95\source\dist
  # å‘å¸ƒé™æ€æ–‡ä»¶
  deploy:
    concurrency: ci-${{ github.ref }}
    needs: [build]
    runs-on: ubuntu-latest
    steps:
      - name: checkout data
        uses: actions/checkout@v3
      # ä¸‹è½½
      - name: download ğŸ“¥
        uses: actions/download-artifact@v1
        with:
          name: site
      # å‘å¸ƒ
      - name: deploy ğŸ‰
        uses: JamesIves/github-pages-deploy-action@v4.3.3
        with:
          branch: ghpage
          folder: 'site'
